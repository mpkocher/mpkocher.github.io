<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<title>
  
    Archive: 2019/6
  
</title>

<meta property="og:type" content="website">
<meta property="og:title">
<meta property="og:url" content="http://mpkocher.github.io/archives/2019/06/index.html">
<meta property="og:site_name">
<meta property="og:locale" content="en_US">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@https:&#x2F;&#x2F;twitter.com&#x2F;ElevenPhonons">


  <link rel="alternative" href="/atom.xml" title="" type="application/atom+xml">



  <link rel="icon" href="/favicon.png">



<link rel="stylesheet" href="/perfect-scrollbar/css/perfect-scrollbar.min.css">


<link rel="stylesheet" href="/styles/main.css">



  <!-- Google Analytics -->
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-141397134-1', 'auto');
    ga('send', 'pageview');

  </script>
  <!-- End Google Analytics -->





<meta name="generator" content="Hexo 6.2.0"></head>
<body
  
    class="monochrome"
  
  >
  <div class="mobile-header">
  <button class="sidebar-toggle" type="button">
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
    <span class="icon-bar"></span>
  </button>
  <a class="title" href="/"></a>
</div>

  <div class="main-container">
    <div class="sidebar">
  <div class="header">
    <h1 class="title"><a href="/"></a></h1>
    
    <div class="info">
      <div class="content">
        
        
      </div>
      
        <div class="avatar">
          
            <a href="/2017/09/04/About"><img src="https://avatars3.githubusercontent.com/u/868552?v=4&amp;s=460"></a>
          
        </div>
      
    </div>
  </div>
  <div class="body">
    
      
        <ul class="nav">
          
            
              <li class="tag-list-container">
                <a href="javascript:;">Tag</a>
                <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/FPT/" rel="tag">FPT</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/functional/" rel="tag">functional</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lbl/" rel="tag">lbl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/materials-project/" rel="tag">materials-project</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mypy/" rel="tag">mypy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pacbio/" rel="tag">pacbio</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/" rel="tag">scala</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala-cli/" rel="tag">scala-cli</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/series/" rel="tag">series</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zio/" rel="tag">zio</a><span class="tag-list-count">1</span></li></ul>
              </li>
            
          
            
              <li class="archive-list-container">
                <a href="javascript:;">Archive</a>
                <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">3</span></li></ul>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="/" title="Homepage" external="false">Homepage</a>
              </li>
            
          
            
              <li>
                <a href="/archives" title="By Year" external="false">By Year</a>
              </li>
            
          
            
              <li>
                <a href="/2019/03/01/Functional-Programming-Techniques-In-Python-Series/" title="Functional Programming Techniques in Python" external="false">Functional Programming Techniques in Python</a>
              </li>
            
          
        </ul>
      
        <ul class="nav">
          
            
              <li>
                <a href="/2017/09/04/About/" title="About" external="false">About</a>
              </li>
            
          
            
              <li>
                <a href="https://github.com/mpkocher/cv/blob/master/academic/cv.pdf" title="CV" target="_blank" rel="noopener">CV</a>
              </li>
            
          
            
              <li>
                <a href="https://github.com/mpkocher" title="Github" target="_blank" rel="noopener">Github</a>
              </li>
            
          
            
              <li>
                <a href="https://gist.github.com/mpkocher" title="Gists" target="_blank" rel="noopener">Gists</a>
              </li>
            
          
            
              <li>
                <a href="https://www.linkedin.com/in/michael-kocher-b4bba5122/" title="LinkedIn" target="_blank" rel="noopener">LinkedIn</a>
              </li>
            
          
            
              <li>
                <a href="https://twitter.com/ElevenPhonons" title="Twitter" target="_blank" rel="noopener">Twitter</a>
              </li>
            
          
            
              <li>
                <a href="/2017/09/04/Now" title="Now" external="false">Now</a>
              </li>
            
          
            
              <li>
                <a href="/atom.xml" title="RSS" external="false">RSS</a>
              </li>
            
          
        </ul>
      
    
  </div>
</div>

    <div class="main-content">
      
        <div style="max-width: 1000px">
      
          

  
  
    
      
      
      <section class="archives-wrap">
        <div class="archive-year-wrap">
          <h1><a href="/archives/2019" class="archive-year">2019</a></h1>
        </div>
        <div class="post-list">
    
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2019/06/21/Python-Dashboards-With-Panel-Kicking-the-Tires/" >
  Python Dashboards with Panel: Kicking the Tires
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2019/06/21/Python-Dashboards-With-Panel-Kicking-the-Tires/"><span class="article-date">
  2019-06-21
</span>
</a>
        

        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p><a target="_blank" rel="noopener" href="https://pyviz.org/">PyViz</a> recently release the first official release (0.60) of <a target="_blank" rel="noopener" href="https://panel.pyviz.org/">Panel</a>. Overall, I’m digging the iterative development model of developing dashboard components within Juypter lab&#x2F;notebook.</p>
<p>Here’s an example notebook that will demonstrate creating a few dashboard components in Panel. The raw notebook can be launched using <a target="_blank" rel="noopener" href="https://mybinder.org/v2/gist/mpkocher/83ac8f99a7b6a4ed87f1f2014ef74c2b/master?filepath=panel-dashboard.ipynb">mybinder.org</a>)</p>
<script src="//gist.github.com/83ac8f99a7b6a4ed87f1f2014ef74c2b.js?file=panel-dashboard.ipynb"></script>



        
      </div>
    </div>

  

  
  
    
  

    <div class="post-list-item article">
      <h3 class="article-header">
        <a href="/2019/06/06/Python-3-8-0b1-Quick-Look/" >
  Python 3.8.0b1 Positional-Only Arguments and the Walrus Operator
</a>

      </h3>
      

      <div class="article-info">
        <a href="/2019/06/06/Python-3-8-0b1-Quick-Look/"><span class="article-date">
  2019-06-06
</span>
</a>
        

        
	<span class="article-tag tagcloud">
		<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>
	</span>


      </div>
      <div class="article-entry">
        
          <p>On June 4th 2019, <a target="_blank" rel="noopener" href="https://github.com/python/cpython/releases/tag/v3.8.0b1">Python 3.8.0b1 was released</a>. The official <a target="_blank" rel="noopener" href="https://docs.python.org/3.8/whatsnew/changelog.html#changelog">changelog is here</a>. </p>
<p>There are two interesting syntactic changes&#x2F;features that were added which I believe are useful to explore in some depth. Specifically, the new “walrus”‘ <code>:=</code> operator and the new Positional-Only function parameter features.</p>
<h2 id="Walrus"><a href="#Walrus" class="headerlink" title="Walrus"></a>Walrus</h2><p>First, the “walrus” expression operator (<code>:=</code>) defined in <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0572/">PEP-572</a></p>
<blockquote>
<p>…naming sub-parts of a large expression can assist an interactive debugger, providing useful display hooks and partial results. Without a way to capture sub-expressions inline, this would require refactoring of the original code; with assignment expressions, this merely requires the insertion of a few name :&#x3D; markers. Removing the need to refactor reduces the likelihood that the code be inadvertently changed as part of debugging (a common cause of Heisenbugs), and is easier to dictate to another programmer.</p>
</blockquote>
<p>A (contrived) example using Python 3.8.0b1 built from source “3.8.0b1+ (heads&#x2F;3.8:23f41a64ea)”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>xs = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>xs</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[(x, y) <span class="keyword">for</span> x <span class="keyword">in</span> xs <span class="keyword">if</span> (y := x * <span class="number">2</span>) &lt; <span class="number">5</span>]</span><br><span class="line">[(<span class="number">0</span>, <span class="number">0</span>), (<span class="number">1</span>, <span class="number">2</span>), (<span class="number">2</span>, <span class="number">4</span>)]</span><br></pre></td></tr></table></figure>

<p>The idea is to use an expression based approach to remove unnecessary chatter and potential bugs of storing local state.</p>
<p>Another simple example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Python 3.8</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rx = re.<span class="built_in">compile</span>(<span class="string">r&#x27;([A-z]*)\.([A-z]*)&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">g</span>(<span class="params">first, last</span>): <span class="keyword">return</span> <span class="string">f&quot;First: <span class="subst">&#123;first&#125;</span> Last: <span class="subst">&#123;last&#125;</span>&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">&#x27;ralph&#x27;</span>, <span class="string">&#x27;steve.smith&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> name <span class="keyword">in</span> names:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">if</span> (match := rx.match(name)): <span class="built_in">print</span>(g(*match.groups()))</span><br><span class="line">First: steve Last: smith</span><br></pre></td></tr></table></figure>

<p>As a side note, many of these “None-ish” based examples in the PEP (somewhat mechanically) look like a <code>map</code>, <code>flatMap</code>, <code>&#39;foreach&#39;</code> on <code>Option[T]</code> cases in Scala. </p>
<p>Python doesn’t really do this well due to its inside-out nature of composing maps&#x2F;filter&#x2F;generators (versus a left to right model). Nevertheless, here’s the example to demonstrate the general idea using a functional centric approach.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">processor</span>(<span class="params">sx</span>): <span class="keyword">return</span> rx.match(sx)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">not_none</span>(<span class="params">x</span>): <span class="keyword">return</span> x <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">def</span> <span class="title function_">printer</span>(<span class="params">x</span>): <span class="built_in">print</span>(g(*x.groups()))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_ = <span class="built_in">list</span>(<span class="built_in">map</span>(printer, <span class="built_in">filter</span>(not_none, <span class="built_in">map</span>(processor, names))))</span><br><span class="line">First: steve Last: smith</span><br></pre></td></tr></table></figure>

<p>The “Exceptional cases” described in the PEP are <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0572/#exceptional-cases">worth investigating in more detail</a>. There’s several cases where “Valid, though probably confusing” is used.</p>
<p>For example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y := f(x)  <span class="comment"># INVALID</span></span><br><span class="line">(y := f(x))  <span class="comment"># Valid, though not recommended</span></span><br></pre></td></tr></table></figure>

<p>Note that the “walrus” operator can also be used in function definitions. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">answer = p := <span class="number">42</span></span>): <span class="keyword">return</span> <span class="string">&quot;&quot;</span> <span class="comment"># INVALID</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">answer=(<span class="params">p := <span class="number">42</span></span>)</span>):  <span class="keyword">return</span> <span class="string">&quot;&quot;</span> <span class="comment"># Valid, though not great style</span></span><br></pre></td></tr></table></figure>


<h2 id="Positional-Only-Args"><a href="#Positional-Only-Args" class="headerlink" title="Positional Only Args"></a>Positional Only Args</h2><p>The other interesting feature added to Python 3.8 is Positional-Only arguments in function definitions.</p>
<p>For as long as I can recall, Python has had this fundamental feature (or bug) on how functions or methods are called. </p>
<p>For example, </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x, y=<span class="number">1234</span></span>): <span class="keyword">return</span> x + y</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f(<span class="number">1</span>)</span><br><span class="line"><span class="number">1235</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f(x=<span class="number">1</span>, y=<span class="number">2</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f(y=<span class="number">1</span>, x=<span class="number">2</span>)</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>Often this fundamental ambiguity of function call “style” isn’t really a big deal. However, it can leak local variable names as part of the public interface.As a result, minor variable renaming can potentially break interfaces. It’s also not clear what should be a keyword only argument or a positional only argument with a default. For example, simply changing <code>f(x, y=1234)</code> to <code>f(n, y=1234)</code> can potentially break the interface depending on the call “style”.</p>
<p>I’ve worked with a few developers over the years that viewed this as a feature and thought that this style made the API calls more explicit. For example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">compute</span>(<span class="params">alpha, beta, gamma</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">compute(alpha=<span class="number">90</span>, gamma=<span class="number">80</span>, beta=<span class="number">120</span>)</span><br></pre></td></tr></table></figure>

<p>I never really liked this looseness of positional vs keyword and would (if possible) try to discourage its use. Regardless, it can be argued this is a feature of the language (at least in Python &lt;&#x3D; 3.7). I would guess that many Python developers are also leveraging the unpacking dict style as well to call functions.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d = <span class="built_in">dict</span>(alpha=<span class="number">90</span>, gamma=<span class="number">70</span>, beta=<span class="number">120</span>)</span><br><span class="line">compute(**d)</span><br></pre></td></tr></table></figure>

<p>In Python 3.0, function definitions using Keyword-Only arguments was added (see <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-3102/">PEP-3102</a> from 2006) using the <code>*</code> delimiter. All arguments to the right of the <code>*</code> are Keyword-Only arguments. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">a, b, *, c=<span class="number">1234</span></span>):</span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br></pre></td></tr></table></figure>

<p>Unfortunately, this still leaves a fundamental issue with clearly defining function arguments. There are three cases: Positional-Only, Positional or Keyword, and Keyword-Only. PEP-3102 only solves the Keyword-Only case and doesn’t address the other two cases. </p>
<p>Hence in Python &lt; 3.8, there’s still a fundamental ambiguity when defining a function and how it can be called.</p>
<p>For example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">a, b=<span class="number">1</span>, *, c=<span class="number">1234</span></span>):</span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line"></span><br><span class="line">f(<span class="number">1</span>, <span class="number">2</span>, c=<span class="number">3</span>)</span><br><span class="line">f(a=<span class="number">1</span>, b=<span class="number">2</span>, c=<span class="number">3</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>Starting with Python 3.8.0, a Positional-Only parameters mechanism was added. The details are captured in <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0570/">PEP-570</a></p>
<p>Similar to the <code>*</code> delimiter in Python 3.0.0 for Keyword-Only args), a <code>/</code> delimiter was added to clearly delineate Positional-Only (or conversely Keyword-Only args) in function or method definitions. This makes the three cases of function arguments unambigious in how they should be called.</p>
<p>Here’s a few examples:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f0</span>(<span class="params">a, b, c=<span class="number">1234</span>, /</span>):</span><br><span class="line">    <span class="comment"># a, b, c are only positional args. </span></span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f1</span>(<span class="params">a, b, /, c=<span class="number">1234</span></span>):</span><br><span class="line">    <span class="comment"># a, b must be a positional,</span></span><br><span class="line">    <span class="comment"># b can be positional or keyword</span></span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f2</span>(<span class="params">a, b, *, c=<span class="number">1234</span></span>):</span><br><span class="line">    <span class="comment"># a, b can be keyword or positional</span></span><br><span class="line">    <span class="comment"># but c MUST be keyword</span></span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f3</span>(<span class="params">a, b, /, *, c=<span class="number">1234</span></span>):</span><br><span class="line">    <span class="comment"># a, b only positional</span></span><br><span class="line">    <span class="comment"># c only keyword</span></span><br><span class="line">    <span class="comment"># e.g., # f3(1, 2, c=3)</span></span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br></pre></td></tr></table></figure>

<p>Combining the <code>/</code> and <code>*</code> with the type annotations yields:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f4</span>(<span class="params">a:<span class="built_in">int</span>, b:<span class="built_in">int</span>, /, *, c:<span class="built_in">int</span>=<span class="number">1234</span></span>):</span><br><span class="line">    <span class="comment"># this can only be called as</span></span><br><span class="line">    <span class="comment"># f4(1, 2, c=3)</span></span><br><span class="line">    <span class="keyword">return</span> a + b + c</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>We can dive a bit deeper and inspect the function signature via <a target="_blank" rel="noopener" href="https://docs.python.org/3.8/library/inspect.html">inspect</a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extractor</span>(<span class="params">f</span>):</span><br><span class="line">    sx = inspect.signature(f)</span><br><span class="line">    <span class="keyword">return</span> [(v.name, v.kind, v.default) <span class="keyword">for</span> v <span class="keyword">in</span> sx.parameters.values()]</span><br></pre></td></tr></table></figure>

<p>Let’s inspect each example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">pf</span>(<span class="params">f</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Function <span class="subst">&#123;f.__name__&#125;</span> with type annotations <span class="subst">&#123;f.__annotations__&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(extractor(f))</span><br></pre></td></tr></table></figure>

<p>Running in the REPL yeilds:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>funcs = (f0, f1, f2, f2, f2, f4)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_ = <span class="built_in">list</span>(<span class="built_in">map</span>(pf, funcs))</span><br><span class="line">Function f0 <span class="keyword">with</span> <span class="built_in">type</span> annotations &#123;&#125;</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, &lt;_ParameterKind.POSITIONAL_ONLY: <span class="number">0</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;b&#x27;</span>, &lt;_ParameterKind.POSITIONAL_ONLY: <span class="number">0</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;c&#x27;</span>, &lt;_ParameterKind.POSITIONAL_ONLY: <span class="number">0</span>&gt;, <span class="number">1234</span>)]</span><br><span class="line">Function f1 <span class="keyword">with</span> <span class="built_in">type</span> annotations &#123;&#125;</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, &lt;_ParameterKind.POSITIONAL_ONLY: <span class="number">0</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;b&#x27;</span>, &lt;_ParameterKind.POSITIONAL_ONLY: <span class="number">0</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;c&#x27;</span>, &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: <span class="number">1</span>&gt;, <span class="number">1234</span>)]</span><br><span class="line">Function f2 <span class="keyword">with</span> <span class="built_in">type</span> annotations &#123;&#125;</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: <span class="number">1</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;b&#x27;</span>, &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: <span class="number">1</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;c&#x27;</span>, &lt;_ParameterKind.KEYWORD_ONLY: <span class="number">3</span>&gt;, <span class="number">1234</span>)]</span><br><span class="line">Function f2 <span class="keyword">with</span> <span class="built_in">type</span> annotations &#123;&#125;</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: <span class="number">1</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;b&#x27;</span>, &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: <span class="number">1</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;c&#x27;</span>, &lt;_ParameterKind.KEYWORD_ONLY: <span class="number">3</span>&gt;, <span class="number">1234</span>)]</span><br><span class="line">Function f2 <span class="keyword">with</span> <span class="built_in">type</span> annotations &#123;&#125;</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: <span class="number">1</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;b&#x27;</span>, &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: <span class="number">1</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;c&#x27;</span>, &lt;_ParameterKind.KEYWORD_ONLY: <span class="number">3</span>&gt;, <span class="number">1234</span>)]</span><br><span class="line">Function f4 <span class="keyword">with</span> <span class="built_in">type</span> annotations &#123;<span class="string">&#x27;a&#x27;</span>: &lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;, <span class="string">&#x27;b&#x27;</span>: &lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;, <span class="string">&#x27;c&#x27;</span>: &lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;&#125;</span><br><span class="line">[(<span class="string">&#x27;a&#x27;</span>, &lt;_ParameterKind.POSITIONAL_ONLY: <span class="number">0</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;b&#x27;</span>, &lt;_ParameterKind.POSITIONAL_ONLY: <span class="number">0</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;inspect._empty&#x27;</span>&gt;), (<span class="string">&#x27;c&#x27;</span>, &lt;_ParameterKind.KEYWORD_ONLY: <span class="number">3</span>&gt;, <span class="number">1234</span>)]</span><br></pre></td></tr></table></figure>

<p>Note, you can use <a target="_blank" rel="noopener" href="https://docs.python.org/3.8/library/inspect.html#inspect.Signature.bind">bind</a> to call the func (this must also adhere to the correct function definition of arg and keywords in the function of interest).</p>
<p>Also, it’s worth noting that both scipy and numpy have been using this <code>/</code> <a target="_blank" rel="noopener" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.gammaln.html">style in the docs</a> for some time. </p>
<h2 id="When-Should-I-Start-Adopting-these-Features"><a href="#When-Should-I-Start-Adopting-these-Features" class="headerlink" title="When Should I Start Adopting these Features?"></a>When Should I Start Adopting these Features?</h2><p>If you’re a library developer that has packages on <a target="_blank" rel="noopener" href="https://pypi.org/">PyPi</a>, it might not be clear when it’s “safe” to start leveraging these features. I was only able to find one source of Python 3 adoption and as a result, I’m only able outline a <strong>very crude model</strong>.</p>
<p>On December 23, 2016, Python 3.6 was officially released. In the Fall of 2018, <a target="_blank" rel="noopener" href="https://www.jetbrains.com/research/python-developers-survey-2018/#python-3-adoption">JetBrains release the Python Developer Survey</a> which contains the Python 2&#x2F;3 breakdown, as well as the breakdown of different versions within Python 3. As of the Fall 2018, 54% of Python 3 developers were using Python 3.6.x. Therefore, using this very crude model, if you assume that the rate of adoption of 3.6 and 3.8 are the same and if the minimum threshold of adoption of 3.8 is 54%, then you’ll need to wait approximately 2 years before starting to leverage these 3.8 features. </p>
<img src="https://github.com/mpkocher/mpkocher.github.io/blob/master/images/jetbrains_python_survey_2018.png?raw=true" alt="Jetbrains Python Survey" height="600">


<p>When you do plan to leverage these 3.8 specific features and pushing a package to the Python Package Index, then I would suggest clearly defining the Python version in the <code>setup.py</code>. For more details, see the official packaging <a href="python_requires='%3E3.5.2'">docs</a> for more details.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setup.py</span></span><br><span class="line">setup(python_requires=<span class="string">&#x27;&gt;=3.8&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="Summary-and-Conclusion"><a href="#Summary-and-Conclusion" class="headerlink" title="Summary and Conclusion"></a>Summary and Conclusion</h1><ul>
<li>Python 3.8 added the “walrus” operator <code>:=</code> that enables results of expressions to be used</li>
<li>It’s recommended reading the <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0572/#exceptional-cases">Exceptional Cases</a> for better understanding of where to (and to not) use the <code>:=</code> operator.</li>
<li>Python 3.8 added Positional-Only function definitions using the <code>/</code> delimiter</li>
<li>Defining functions with Positional-Only arguments will require a trailing <code>/</code> in the definition. E.g., <code>def adder(n, m, /): return 0</code></li>
<li>There are changes in the standard lib to communicate. It’s not clear how locked down or backward compatible the interfaces were changes. Here’s a random example of the function signature of <a target="_blank" rel="noopener" href="https://docs.python.org/3.8/library/functools.html#functools.partial">functools.partial</a> being updated to use <code>/</code>.</li>
<li>Positional-Only arguments should improve consistency of API calls across Python runtimes (e.g., cpython and pypi)</li>
<li>The Positional-Only PEP-570 outlines improvements in performance, however, I wasn’t able to find any performance studies on this topic.</li>
<li>Migrating to 3.8 might involve potentially breaking API changes based on the usage of <code>/</code> in the Python 3.8 standard lib</li>
<li>For core library authors of libs on pypi, I would recommend  using the crude approximation (described above) of approximately 2 years away from being able to adopt the new 3.8 features</li>
<li>For <code>mypy</code> users, you might want to make sure you investigate the supported versions of Python 3.8 (<a target="_blank" rel="noopener" href="https://github.com/python/mypy/issues/6545">More Details</a> on the compatiblity matrix)</li>
</ul>
<p>I understand the general motivation to solve core friction points or ambiguities at the language level, however, the new syntatic changes are a little too noisy for my tastes. Specifically the Positional-Only <code>/</code> combined with the <code>*</code> and type annotations. Regardless, the (Python 3.8) ship has sailed long ago. I would encourage the Python community to periodically track and provide feedback on the current <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/">PEP</a>s to help guide the evolution of the Python programming language. And finally, Python 3.8.0 (beta and future 3.8 RCs) bugs should be filed to <a target="_blank" rel="noopener" href="https://bugs.python.org/">https://bugs.python.org</a> . </p>
<p>Best to you and your Python-ing!</p>
<h2 id="Further-Reading"><a href="#Further-Reading" class="headerlink" title="Further Reading"></a>Further Reading</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.python.org/downloads/release/python-380b1/">Full Python 3.8.0b1</a> release notes</li>
<li><a target="_blank" rel="noopener" href="https://news.ycombinator.com/item?id=19690152">Hacker News</a> discussion on Positional-Only feature</li>
<li><a target="_blank" rel="noopener" href="https://medium.com/hultner/try-out-walrus-operator-in-python-3-8-d030ce0ce601">Alexander Hutner</a> covering walrus feature</li>
<li><a target="_blank" rel="noopener" href="https://bugs.python.org/">Bug Tracker</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.python.org/3.8/whatsnew/changelog.html#changelog">Python 3.8 ChangeLog</a></li>
<li><a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/">Python PEP</a>s</li>
</ul>
<p>P.S. A reminder that the PSF has a <a target="_blank" rel="noopener" href="https://www.python.org/psf/donations/2019-q2-drive/">Q2 2019 fundraiser</a> that ends June 30th.</p>

        
      </div>
    </div>

  






          <div class="main-footer">
  
    © 2022  - Powered by <a href="http://hexo.io" target="_blank">Hexo</a> - Theme <a href="https://github.com/denjones/hexo-theme-chan" target="_blank">Chan</a>
  
</div>

      
        </div>
      
    </div>
  </div>
  
<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>


  
<link rel="stylesheet" href="/PhotoSwipe/photoswipe.css">

  
<link rel="stylesheet" href="/PhotoSwipe/default-skin/default-skin.css">


  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
             It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
                PhotoSwipe keeps only 3 of them in the DOM to save memory.
                Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->

          <div class="pswp__counter"></div>

          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

          <button class="pswp__button pswp__button--share" title="Share"></button>

          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
                <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  
<script src="/PhotoSwipe/photoswipe.js"></script>

  
<script src="/PhotoSwipe/photoswipe-ui-default.js"></script>




<script src="/perfect-scrollbar/js/min/perfect-scrollbar.min.js"></script>


<script src="/scripts/main.js"></script>


</body>
</html>
